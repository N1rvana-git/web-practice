{
  "name": "Rikas è¯•ç”¨ç”³è¯·é€šçŸ¥",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "trial-application",
        "options": {
          "rawBody": false
        }
      },
      "name": "Webhook æ¥æ”¶è¯•ç”¨ç”³è¯·",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [
        250,
        300
      ],
      "webhookId": "trial-application",
      "id": "webhook-node-1"
    },
    {
      "parameters": {
        "jsCode": "// å¤„ç†è¡¨å•æ•°æ®å¹¶æ ¼å¼åŒ–ä¸ºé£ä¹¦å¡ç‰‡\nconst formData = $input.item.json.body;\n\n// å›¢é˜Ÿè§„æ¨¡æ˜ å°„\nconst teamSizeMap = {\n  '1-10': '1-10äºº',\n  '11-50': '11-50äºº',\n  '51-200': '51-200äºº',\n  '201-500': '201-500äºº',\n  '500+': '500äººä»¥ä¸Š'\n};\n\n// æ„å»ºé£ä¹¦å¡ç‰‡æ¶ˆæ¯\nconst feishuCard = {\n  msg_type: 'interactive',\n  card: {\n    config: {\n      wide_screen_mode: true\n    },\n    header: {\n      title: {\n        tag: 'plain_text',\n        content: 'ğŸ‰ æ–°çš„è¯•ç”¨ç”³è¯·'\n      },\n      template: 'blue'\n    },\n    elements: [\n      {\n        tag: 'div',\n        text: {\n          tag: 'lark_md',\n          content: `**ç”³è¯·æ—¶é—´:** ${new Date().toLocaleString('zh-CN', { timeZone: 'Asia/Shanghai' })}`\n        }\n      },\n      {\n        tag: 'hr'\n      },\n      {\n        tag: 'div',\n        fields: [\n          {\n            is_short: true,\n            text: {\n              tag: 'lark_md',\n              content: `**å§“å:**\\n${formData.firstName || ''} ${formData.lastName || ''}`\n            }\n          },\n          {\n            is_short: true,\n            text: {\n              tag: 'lark_md',\n              content: `**èŒä½:**\\n${formData.jobTitle || 'æœªå¡«å†™'}`\n            }\n          },\n          {\n            is_short: true,\n            text: {\n              tag: 'lark_md',\n              content: `**é‚®ç®±:**\\n${formData.workEmail || ''}`\n            }\n          },\n          {\n            is_short: true,\n            text: {\n              tag: 'lark_md',\n              content: `**ç”µè¯:**\\n${formData.phone || 'æœªå¡«å†™'}`\n            }\n          },\n          {\n            is_short: true,\n            text: {\n              tag: 'lark_md',\n              content: `**å…¬å¸:**\\n${formData.company || ''}`\n            }\n          },\n          {\n            is_short: true,\n            text: {\n              tag: 'lark_md',\n              content: `**å›¢é˜Ÿè§„æ¨¡:**\\n${teamSizeMap[formData.teamSize] || formData.teamSize}`\n            }\n          }\n        ]\n      },\n      {\n        tag: 'hr'\n      },\n      {\n        tag: 'div',\n        text: {\n          tag: 'lark_md',\n          content: `**è®¢é˜…è¥é”€ä¿¡æ¯:** ${formData.subscribe ? 'âœ… æ˜¯' : 'âŒ å¦'}`\n        }\n      },\n      {\n        tag: 'hr'\n      },\n      {\n        tag: 'note',\n        elements: [\n          {\n            tag: 'plain_text',\n            content: 'è¯·å°½å¿«è”ç³»å®¢æˆ·ï¼Œæä¾›è¯•ç”¨è´¦å·å’Œäº§å“æ¼”ç¤º'\n          }\n        ]\n      },\n      {\n        tag: 'action',\n        actions: [\n          {\n            tag: 'button',\n            text: {\n              tag: 'plain_text',\n              content: 'å‘é€è¯•ç”¨è´¦å·'\n            },\n            type: 'primary',\n            url: `mailto:${formData.workEmail}?subject=æ¬¢è¿è¯•ç”¨ Rikas AI&body=æ‚¨å¥½ ${formData.firstName}ï¼Œ`\n          },\n          {\n            tag: 'button',\n            text: {\n              tag: 'plain_text',\n              content: 'æŸ¥çœ‹è¯¦æƒ…'\n            },\n            type: 'default',\n            url: 'https://rikas.ai/admin/trials'\n          }\n        ]\n      }\n    ]\n  }\n};\n\nreturn {\n  json: {\n    feishuCard: feishuCard,\n    originalData: formData,\n    timestamp: new Date().toISOString()\n  }\n};"
      },
      "name": "æ ¼å¼åŒ–ä¸ºé£ä¹¦å¡ç‰‡",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        450,
        300
      ],
      "id": "code-node-1"
    },
    {
      "parameters": {
        "url": "={{ $env.FEISHU_WEBHOOK_URL }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": []
        },
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify($json.feishuCard) }}",
        "options": {}
      },
      "name": "å‘é€åˆ°é£ä¹¦",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        650,
        300
      ],
      "id": "http-node-1"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ JSON.stringify({\n  success: true,\n  message: 'ç”³è¯·å·²æäº¤ï¼Œæˆ‘ä»¬ä¼šå°½å¿«ä¸æ‚¨è”ç³»',\n  timestamp: $json.timestamp\n}) }}"
      },
      "name": "è¿”å›æˆåŠŸå“åº”",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [
        850,
        300
      ],
      "id": "respond-node-1"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseCode": 500,
        "responseBody": "={{ JSON.stringify({\n  success: false,\n  message: 'æäº¤å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•',\n  error: $json.error\n}) }}"
      },
      "name": "è¿”å›é”™è¯¯å“åº”",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [
        850,
        450
      ],
      "id": "respond-error-node-1"
    }
  ],
  "connections": {
    "Webhook æ¥æ”¶è¯•ç”¨ç”³è¯·": {
      "main": [
        [
          {
            "node": "æ ¼å¼åŒ–ä¸ºé£ä¹¦å¡ç‰‡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ ¼å¼åŒ–ä¸ºé£ä¹¦å¡ç‰‡": {
      "main": [
        [
          {
            "node": "å‘é€åˆ°é£ä¹¦",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å‘é€åˆ°é£ä¹¦": {
      "main": [
        [
          {
            "node": "è¿”å›æˆåŠŸå“åº”",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "è¿”å›é”™è¯¯å“åº”",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-01-13T00:00:00.000Z",
  "versionId": "1"
}
